{"version":3,"file":"view.js","mappings":";;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,CAAC,YAAW;EACX,SAASA,cAAcA,CAAA,EAAG;IACzB,MAAMC,UAAU,GAAGC,QAAQ,CAACC,gBAAgB,CAAC,eAAe,CAAC;IAC7DF,UAAU,CAACG,OAAO,CAACC,SAAS,IAAI;MAC/B,MAAMC,OAAO,GAAGD,SAAS,CAACE,YAAY,CAAC,eAAe,CAAC;MACvD,MAAMC,MAAM,GAAGH,SAAS,CAACE,YAAY,CAAC,cAAc,CAAC;MACrD,MAAME,KAAK,GAAGJ,SAAS,CAACK,EAAE;MAE1B,IAAIJ,OAAO,KAAK,KAAK,EAAE;QACtBK,SAAS,CAACC,KAAK,CAACJ,MAAM,EAAG,IAAGC,KAAM,EAAC,CAAC;MACrC,CAAC,MAAM,IAAIH,OAAO,KAAK,UAAU,EAAE;QAClCO,KAAK,CAACL,MAAM,CAAC,CACXM,IAAI,CAACC,QAAQ,IAAIA,QAAQ,CAACC,IAAI,CAAC,CAAC,CAAC,CACjCF,IAAI,CAACE,IAAI,IAAI;UACbX,SAAS,CAACY,SAAS,GAAGC,MAAM,CAACC,KAAK,CAACH,IAAI,CAAC;QACzC,CAAC,CAAC;MACJ,CAAC,MAAM,IAAIV,OAAO,KAAK,MAAM,EAAE;QAC9BO,KAAK,CAACL,MAAM,CAAC,CACXM,IAAI,CAACC,QAAQ,IAAIA,QAAQ,CAACK,WAAW,CAAC,CAAC,CAAC,CACxCN,IAAI,CAACM,WAAW,IAAIC,OAAO,CAACC,aAAa,CAAC;UAAEF;QAAY,CAAC,CAAC,CAAC,CAC3DN,IAAI,CAACS,MAAM,IAAI;UACflB,SAAS,CAACY,SAAS,GAAGM,MAAM,CAACC,KAAK;QACnC,CAAC,CAAC,CACDC,KAAK,CAACC,OAAO,CAACC,KAAK,CAAC;MACvB,CAAC,MAAM,IAAIrB,OAAO,KAAK,OAAO,EAAE;QAC/BO,KAAK,CAACL,MAAM,CAAC,CACXM,IAAI,CAACC,QAAQ,IAAIA,QAAQ,CAACK,WAAW,CAAC,CAAC,CAAC,CACxCN,IAAI,CAACM,WAAW,IAAI;UACpB,MAAMQ,IAAI,GAAG,IAAIC,UAAU,CAACT,WAAW,CAAC;UACxC,MAAMU,QAAQ,GAAGC,IAAI,CAACC,IAAI,CAACJ,IAAI,EAAE;YAAEK,IAAI,EAAE;UAAQ,CAAC,CAAC;UACnD,MAAMC,IAAI,GAAGH,IAAI,CAACI,KAAK,CAACC,aAAa,CAACN,QAAQ,CAACO,MAAM,CAACP,QAAQ,CAACQ,UAAU,CAAC,CAAC,CAAC,CAAC,CAAC;UAC9EjC,SAAS,CAACY,SAAS,GAAGiB,IAAI;QAC3B,CAAC,CAAC,CACDT,KAAK,CAACC,OAAO,CAACC,KAAK,CAAC;MACvB;IACD,CAAC,CAAC;EACH;EAEAzB,QAAQ,CAACqC,gBAAgB,CAAC,kBAAkB,EAAEvC,cAAc,CAAC;AAC9D,CAAC,EAAE,CAAC,C","sources":["webpack://document-viewer/./src/view.js"],"sourcesContent":["/**\n * Use this file for JavaScript code that you want to run in the front-end\n * on posts/pages that contain this block.\n *\n * When this file is defined as the value of the `viewScript` property\n * in `block.json` it will be enqueued on the front end of the site.\n *\n * Example:\n *\n * ```js\n * {\n *   \"viewScript\": \"file:./view.js\"\n * }\n * ```\n *\n * If you're not making any changes to this file because your project doesn't need any\n * JavaScript running in the front-end, then you should delete this file and remove\n * the `viewScript` property from `block.json`.\n *\n * @see https://developer.wordpress.org/block-editor/reference-guides/block-api/block-metadata/#view-script\n */\n\n(function() {\n\tfunction renderDocument() {\n\t\tconst containers = document.querySelectorAll('.dv-container');\n\t\tcontainers.forEach(container => {\n\t\t\tconst docType = container.getAttribute('data-doc-type');\n\t\t\tconst docUrl = container.getAttribute('data-doc-url');\n\t\t\tconst domId = container.id;\n\n\t\t\tif (docType === 'pdf') {\n\t\t\t\tPDFObject.embed(docUrl, `#${domId}`);\n\t\t\t} else if (docType === 'markdown') {\n\t\t\t\tfetch(docUrl)\n\t\t\t\t\t.then(response => response.text())\n\t\t\t\t\t.then(text => {\n\t\t\t\t\t\tcontainer.innerHTML = marked.parse(text);\n\t\t\t\t\t});\n\t\t\t} else if (docType === 'docx') {\n\t\t\t\tfetch(docUrl)\n\t\t\t\t\t.then(response => response.arrayBuffer())\n\t\t\t\t\t.then(arrayBuffer => mammoth.convertToHtml({ arrayBuffer }))\n\t\t\t\t\t.then(result => {\n\t\t\t\t\t\tcontainer.innerHTML = result.value;\n\t\t\t\t\t})\n\t\t\t\t\t.catch(console.error);\n\t\t\t} else if (docType === 'excel') {\n\t\t\t\tfetch(docUrl)\n\t\t\t\t\t.then(response => response.arrayBuffer())\n\t\t\t\t\t.then(arrayBuffer => {\n\t\t\t\t\t\tconst data = new Uint8Array(arrayBuffer);\n\t\t\t\t\t\tconst workbook = XLSX.read(data, { type: 'array' });\n\t\t\t\t\t\tconst html = XLSX.utils.sheet_to_html(workbook.Sheets[workbook.SheetNames[0]]);\n\t\t\t\t\t\tcontainer.innerHTML = html;\n\t\t\t\t\t})\n\t\t\t\t\t.catch(console.error);\n\t\t\t}\n\t\t});\n\t}\n\n\tdocument.addEventListener('DOMContentLoaded', renderDocument);\n})();\n"],"names":["renderDocument","containers","document","querySelectorAll","forEach","container","docType","getAttribute","docUrl","domId","id","PDFObject","embed","fetch","then","response","text","innerHTML","marked","parse","arrayBuffer","mammoth","convertToHtml","result","value","catch","console","error","data","Uint8Array","workbook","XLSX","read","type","html","utils","sheet_to_html","Sheets","SheetNames","addEventListener"],"sourceRoot":""}